<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test fetch</title>
</head>
<body>
    <button id='fetch'>Fetch avec body content</button>
    <button id='fetch2'>Fetch avec fonction</button>

    <script>
        let fetchButton=document.getElementById('fetch');
        let fetchButton2 = document.getElementById('fetch2');
        let apilink='http://localhost:3000/api/teddies/order';
        
            
        const prod=()=>{
            return ['5beaa8bf1c9d440000a57d94', '5be9c8541c9d440000665243'];
        }

        const conta=()=>{
            return {
                firstName: 'a',
                lastName: 'b',
                address: 'c',
                city: 'd',
                email: 'a.b@gmail.com'};
        }

        let bodycontent = {
                contact: {
                    firstName: 'a',
                    lastName: 'b',
                    address: 'c',
                    city: 'd',
                    email: 'a.b@gmail.com'
                },
                products: ['5beaa8bf1c9d440000a57d94', '5be9c8541c9d440000665243']
            }

        let bodyFonction={
            contact:conta(),
            products:prod()
        }

        fetchButton.addEventListener('click',()=>{
            //callingF(bodycontent)
            fetch(apilink, {
                method: "POST",
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(bodycontent)
            })
            .then((res)=>{
                    console.log('fetch bodycontent: '+bodycontent.contact.firstName+' '+bodycontent.products);
                   
                    return res.json()
                })
            .then((value)=>{
                    console.log('lac titi caca');
                    console.log(value);         
                   
                    })
            .catch((error)=>{
                    console.log(error.message)
                    console.log('test 3')}
                    );
        });

        fetchButton2.addEventListener('click', () => {
                //callingF(bodycontent)
                fetch(apilink, {
                    method: "POST",
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(bodyFonction)
                })
                    .then((res) => {
                        console.log('fetch bodycontent: ' + bodyFonction.contact.firstName + ' ' + bodyFonction.products);

                        return res.json()
                    })
                    .then((value) => {
                        console.log('lac titi caca');
                        console.log(value);

                    })
                    .catch((error) => {
                        console.log(error.message)
                        console.log('test 3')
                    }
                    );
            });


        /*extrait du controler
    * Expects request to contain:
        * contact: {
        * firstName: string,
        * lastName: string,
        * address: string,
        * city: string,
        * email: string
                        * }
        * products: [string] < --array of product _id
            *
 * 
        exports.orderTeddies = (req, res, next) => {
            if (!req.body.contact ||
                !req.body.contact.firstName ||
                !req.body.contact.lastName ||
                !req.body.contact.address ||
                !req.body.contact.city ||
                !req.body.contact.email ||
                !req.body.products) {
*/

    


    
    </script>
</body>
</html>